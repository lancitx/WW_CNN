# WOA - CNN and BWO - CNN

åŸºäº**é²¸é±¼WOA/ç™½é²¸BWOä¼˜åŒ–ç®—æ³•**åœ¨CNNé¢„æµ‹é“è·¯é‡Œç¨‹æ•°æ®ä¸Šçš„åº”ç”¨ã€‚

å¼€æºåœ°å€ï¼š[lancitx/WW_CNN](https://github.com/lancitx/WW_CNN)

---

## 1. é¢„å‡†å¤‡

- åŸå§‹æ•°æ®ï¼š

```python
# åŸå§‹æ•°æ®
data = np.array([
    [5.33, 5.39, 5.29, 5.41, 5.45, 5.50],
    [5.39, 5.29, 5.41, 5.50, 5.57, 5.57],
    [5.29, 5.41, 5.45, 5.50, 5.57, 5.58],
    [5.41, 5.45, 5.50, 5.57, 5.58, 5.61],
    [5.45, 5.50, 5.57, 5.58, 5.61, 5.69],
    [5.50, 5.57, 5.58, 5.61, 5.69, 5.78],
    [5.57, 5.58, 5.61, 5.69, 5.78, 5.78],
    [5.58, 5.61, 5.69, 5.78, 5.78, 5.81],
    [5.61, 5.69, 5.78, 5.78, 5.81, 5.86],
    [5.69, 5.78, 5.78, 5.81, 5.86, 5.90],
    [5.78, 5.78, 5.81, 5.86, 5.90, 5.97],
    [5.78, 5.81, 5.86, 5.90, 5.97, 6.49],
    [5.81, 5.86, 5.90, 5.97, 6.49, 6.60],
    [5.86, 5.90, 5.97, 6.49, 6.60, 6.64],
    [5.90, 5.97, 6.49, 6.60, 6.64, 6.74],
    [5.97, 6.49, 6.60, 6.64, 6.74, 6.87],
    [6.49, 6.60, 6.64, 6.74, 6.87, 7.01]
])
```

-  ç¯å¢ƒé…ç½®

é…ç½®è™šæ‹Ÿç¯å¢ƒï¼š`Anaconda` + `pycharm`

```bash
# æ–°å»ºä¸€ä¸ªcondaç¯å¢ƒï¼Œå‘½åä¸ºCNN
conda create -n CNN python=3.8 -y
conda activate CNN

# å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…
pip install tensorflow==2.12.0  # æ·±åº¦å­¦ä¹ æ¡†æ¶
pip install scikit-learn==1.2.2  # æ•°æ®é¢„å¤„ç†å’Œæ ‡å‡†åŒ–
pip install numpy==1.23.5  # æ•°å€¼è®¡ç®—
pip install pandas==1.5.3  # æ•°æ®å¤„ç†
pip install matplotlib==3.7.1  # å¯è§†åŒ–ï¼Œå¯é€‰
pip install tqdm  # è¿›åº¦æ¡å·¥å…·ï¼Œå¯é€‰
```

---

## 2. å®éªŒ

**çº¯CNNé¢„æµ‹ç»“æœ**ï¼š

```txt
=== Fixed CNN Time Series Prediction Model ===

Training set shape: (14, 5, 1)
Test set shape: (3, 5, 1)
Training data range: 5.500 - 6.640
Test data range: 6.740 - 7.010

Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv1d (Conv1D)             (None, 5, 16)             48        
                                                                 
 dropout (Dropout)           (None, 5, 16)             0         
                                                                 
 conv1d_1 (Conv1D)           (None, 5, 8)              264       
                                                                 
 global_max_pooling1d (Globa  (None, 8)                0         
 lMaxPooling1D)                                                  
                                                                 
 dense (Dense)               (None, 16)                144       
                                                                 
 dropout_1 (Dropout)         (None, 16)                0         
                                                                 
 dense_1 (Dense)             (None, 1)                 17        
                                                                 
=================================================================
Total params: 473
Trainable params: 473
Non-trainable params: 0
_________________________________________________________________

Starting training...

=== Model Evaluation Results ===
Training RÂ²: 0.8268
Training MAPE: 0.02%
Test RÂ²: -2.6323
Test MSE: 0.044153
Test MAE: 0.171344
Test MAPE: 0.02%

=== Prediction Results ===
Sample 15: Actual = 6.7400, Predicted = 6.7584, Error = 0.0184 (0.27%)
Sample 16: Actual = 6.8700, Predicted = 7.0497, Error = 0.1797 (2.62%)
Sample 17: Actual = 7.0100, Predicted = 7.3260, Error = 0.3160 (4.51%)

=== Model Diagnostics ===
Model complexity: 473 parameters
Overfitting indicator: 3.4591
âš ï¸  Warning: Possible overfitting detected!
```

è®­ç»ƒæ•ˆæœï¼š

![cnn_prediction_final](./img/cnn_prediction.png)



**woa_cnné¢„æµ‹ç»“æœ**ï¼š

```txt
=== ğŸš€ ä¼˜åŒ–ç‰ˆ WOA-CNN è¶…å‚æ•°æœç´¢ç³»ç»Ÿ ===

å¼€å§‹WOAè¶…å‚æ•°ä¼˜åŒ–...
ğŸ‹ åˆå§‹åŒ–é²¸é±¼ç¾¤ä½“...
é²¸é±¼ 1: é€‚åº”åº¦ = 0.6649
é²¸é±¼ 2: é€‚åº”åº¦ = 0.7295
é²¸é±¼ 3: é€‚åº”åº¦ = 1.2334
é²¸é±¼ 4: é€‚åº”åº¦ = 0.5080
é²¸é±¼ 5: é€‚åº”åº¦ = 0.9460
åˆå§‹æœ€ä¼˜é€‚åº”åº¦: 0.508011
ğŸ” WOAä¼˜åŒ–è¿›åº¦:  17%|â–ˆâ–‹        | 1/6 [00:07<00:36,  7.28s/it]ç¬¬ 1 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.508011, æ”¹è¿› 3 ä¸ªä¸ªä½“
ğŸ” WOAä¼˜åŒ–è¿›åº¦:  33%|â–ˆâ–ˆâ–ˆâ–      | 2/6 [00:15<00:30,  7.55s/it]ç¬¬ 2 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.404703, æ”¹è¿› 2 ä¸ªä¸ªä½“
ç¬¬ 3 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.404703, æ”¹è¿› 1 ä¸ªä¸ªä½“
ğŸ” WOAä¼˜åŒ–è¿›åº¦:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:29<00:14,  7.27s/it]ç¬¬ 4 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.404703, æ”¹è¿› 1 ä¸ªä¸ªä½“
ç¬¬ 5 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.404703, æ”¹è¿› 0 ä¸ªä¸ªä½“
ğŸ” WOAä¼˜åŒ–è¿›åº¦: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:43<00:00,  7.25s/it]
ç¬¬ 6 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.404703, æ”¹è¿› 1 ä¸ªä¸ªä½“

âœ… WOAä¼˜åŒ–å®Œæˆ!
æœ€ä¼˜è¶…å‚æ•°ç»„åˆ:
  - Conv1æ»¤æ³¢å™¨: 9
  - Conv2æ»¤æ³¢å™¨: 9
  - å…¨è¿æ¥å•å…ƒ: 15
  - å­¦ä¹ ç‡: 0.00388
  - Dropoutç‡: 0.100
  - æœ€ä¼˜é€‚åº”åº¦: 0.404703

ğŸ‹ï¸ å¼€å§‹è®­ç»ƒæœ€ç»ˆæ¨¡å‹...

ğŸ“Š === æœ€ç»ˆæ¨¡å‹æ€§èƒ½è¯„ä¼° ===
è®­ç»ƒé›†:
  RÂ² = 0.9894
  MSE = 0.001462
  MAE = 0.028399

æµ‹è¯•é›†:
  RÂ² = -7.2347
  MSE = 0.100097
  MAE = 0.315950

ğŸ¯ è¯¦ç»†é¢„æµ‹ç»“æœ:
  æ ·æœ¬15: çœŸå®=6.7400, é¢„æµ‹=7.0335, è¯¯å·®=0.2935 (4.4%)
  æ ·æœ¬16: çœŸå®=6.8700, é¢„æµ‹=7.1916, è¯¯å·®=0.3216 (4.7%)
  æ ·æœ¬17: çœŸå®=7.0100, é¢„æµ‹=7.3427, è¯¯å·®=0.3327 (4.7%)

ğŸ” æ¨¡å‹è¯Šæ–­:
  è¿‡æ‹ŸåˆæŒ‡æ ‡: 8.2240
  æ¨¡å‹å¤æ‚åº¦: 410 å‚æ•°
  âš ï¸  è½»å¾®è¿‡æ‹Ÿåˆ
å›¾è¡¨å·²ä¿å­˜åˆ°: ../img/woa_cnn_optimized_results.png

ğŸ‰ WOAä¼˜åŒ–çš„æœ€ä¼˜è¶…å‚æ•°:
   Conv1æ»¤æ³¢å™¨: 9
   Conv2æ»¤æ³¢å™¨: 9
   å…¨è¿æ¥å•å…ƒ: 15
   å­¦ä¹ ç‡: 0.00388
   Dropoutç‡: 0.100

ğŸ‰ ä¼˜åŒ–å®Œæˆï¼
```

è®­ç»ƒæ•ˆæœï¼š

![woa_cnn_final](./img/woa_cnn_optimized_results.png)

**bwo_cnné¢„æµ‹æ•ˆæœ**ï¼š

```txt
=== ğŸš€ ä¼˜åŒ–ç‰ˆ BWO-CNN è¶…å‚æ•°æœç´¢ç³»ç»Ÿ ===

å¼€å§‹BWOè¶…å‚æ•°ä¼˜åŒ–...
ğŸ³ åˆå§‹åŒ–ç™½é²¸ç¾¤ä½“...
ç™½é²¸ 1: é€‚åº”åº¦ = 0.6649
ç™½é²¸ 2: é€‚åº”åº¦ = 0.7295
ç™½é²¸ 3: é€‚åº”åº¦ = 1.2334
ç™½é²¸ 4: é€‚åº”åº¦ = 0.5080
ç™½é²¸ 5: é€‚åº”åº¦ = 0.9460
åˆå§‹æœ€ä¼˜é€‚åº”åº¦: 0.508011
ğŸ” BWOä¼˜åŒ–è¿›åº¦:  17%|â–ˆâ–‹        | 1/6 [00:07<00:35,  7.16s/it]ç¬¬ 1 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.508011, æ”¹è¿› 2 ä¸ªä¸ªä½“
ç¬¬ 2 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.508011, æ”¹è¿› 1 ä¸ªä¸ªä½“
ğŸ” BWOä¼˜åŒ–è¿›åº¦:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:21<00:21,  7.19s/it]ç¬¬ 3 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.508011, æ”¹è¿› 2 ä¸ªä¸ªä½“
ç¬¬ 4 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.508011, æ”¹è¿› 0 ä¸ªä¸ªä½“
ğŸ” BWOä¼˜åŒ–è¿›åº¦:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 5/6 [00:35<00:07,  7.03s/it]ç¬¬ 5 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.508011, æ”¹è¿› 1 ä¸ªä¸ªä½“
ğŸ” BWOä¼˜åŒ–è¿›åº¦: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:42<00:00,  7.04s/it]
ç¬¬ 6 ä»£: æœ€ä¼˜é€‚åº”åº¦ = 0.486518, æ”¹è¿› 3 ä¸ªä¸ªä½“

âœ… BWOä¼˜åŒ–å®Œæˆ!
æœ€ä¼˜è¶…å‚æ•°ç»„åˆ:
  - Conv1æ»¤æ³¢å™¨: 9
  - Conv2æ»¤æ³¢å™¨: 7
  - å…¨è¿æ¥å•å…ƒ: 18
  - å­¦ä¹ ç‡: 0.00441
  - Dropoutç‡: 0.206
  - æœ€ä¼˜é€‚åº”åº¦: 0.486518

ğŸ‹ï¸ å¼€å§‹è®­ç»ƒæœ€ç»ˆæ¨¡å‹...

ğŸ“Š === æœ€ç»ˆæ¨¡å‹æ€§èƒ½è¯„ä¼° ===
è®­ç»ƒé›†:
  RÂ² = 0.9790
  MSE = 0.002894
  MAE = 0.045870

æµ‹è¯•é›†:
  RÂ² = -8.8401
  MSE = 0.119612
  MAE = 0.338295

ğŸ¯ è¯¦ç»†é¢„æµ‹ç»“æœ:
  æ ·æœ¬15: çœŸå®=6.7400, é¢„æµ‹=7.0034, è¯¯å·®=0.2634 (3.9%)
  æ ·æœ¬16: çœŸå®=6.8700, é¢„æµ‹=7.1862, è¯¯å·®=0.3162 (4.6%)
  æ ·æœ¬17: çœŸå®=7.0100, é¢„æµ‹=7.4453, è¯¯å·®=0.4353 (6.2%)

ğŸ” æ¨¡å‹è¯Šæ–­:
  è¿‡æ‹ŸåˆæŒ‡æ ‡: 9.8190
  æ¨¡å‹å¤æ‚åº¦: 349 å‚æ•°
  âš ï¸  è½»å¾®è¿‡æ‹Ÿåˆ
å›¾è¡¨å·²ä¿å­˜åˆ°: ../img/bwo_cnn_optimized_results.png

ğŸ‰ BWOä¼˜åŒ–çš„æœ€ä¼˜è¶…å‚æ•°:
   Conv1æ»¤æ³¢å™¨: 9
   Conv2æ»¤æ³¢å™¨: 7
   å…¨è¿æ¥å•å…ƒ: 18
   å­¦ä¹ ç‡: 0.00441
   Dropoutç‡: 0.206

ğŸ‰ ä¼˜åŒ–å®Œæˆï¼
```

è®­ç»ƒåŠé¢„æµ‹æ•ˆæœï¼š

![bwo_cnn_final](./img/bwo_cnn_optimized_results.png)

